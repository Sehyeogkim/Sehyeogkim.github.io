<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ch (?) Fenicsx and Parallel Computing | Sehyeog Kim</title>
  <link rel="stylesheet" href="../../../assets/css/style.css">
</head>
<body>
  <!-- Mobile header -->
  <header class="mobile-header">
    <span class="site-title">Sehyeog Kim</span>
    <button class="menu-toggle" aria-label="Menu">&#9776;</button>
  </header>
  <div class="sidebar-overlay"></div>

  <div class="site-wrapper">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="sidebar-bg">
        <img src="../../../assets/images/bg.jpg" alt="Background"
             onerror="this.style.display='none'">
      </div>
      <div class="sidebar-profile">
        <img class="profile-photo"
             src="../../../assets/images/profile.jpg"
             alt="Sehyeog Kim"
             onerror="this.style.background='#21262d'">
        <h1 class="profile-name">Sehyeog Kim</h1>
        <p class="profile-bio">AI &amp; Computational Engineering<br>Knowledge Base</p>
        <div class="profile-links">
          <a href="https://github.com/Sehyeogkim" target="_blank" rel="noopener">
            <svg viewBox="0 0 16 16" width="16" height="16" fill="currentColor"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/></svg> GitHub
          </a>
        </div>
      </div>
      <nav class="sidebar-nav">
        <a href="/" class="nav-item nav-home">Home</a>
        <span class="nav-label">Categories</span>
        <a href="/blog/agentic-ai/" class="nav-item">Agentic_AI<span class="nav-post-count">8</span></a>
        <a href="/blog/blood-flow-and-metabolism/" class="nav-item">Blood-Flow-and-Metabolism<span class="nav-post-count">12</span></a>
        <a href="/blog/cardiovascular-diseases/" class="nav-item">CardioVascular-Diseases<span class="nav-post-count">8</span></a>
        <a href="/blog/computational-linear-algebra/" class="nav-item active">Computational-Linear-Algebra<span class="nav-post-count">15</span></a>
        <a href="/blog/continuum-mechanics/" class="nav-item">Continuum-Mechanics<span class="nav-post-count">9</span></a>
        <a href="/blog/deep-learning/" class="nav-item">Deep-learning<span class="nav-post-count">14</span></a>
        <a href="/blog/finite-element-method/" class="nav-item">Finite-Element-Method<span class="nav-post-count">1</span></a>
        <a href="/blog/fluid-mechanics/" class="nav-item">Fluid-Mechanics<span class="nav-post-count">18</span></a>
        <a href="/blog/gas-dynamics/" class="nav-item">Gas-Dynamics<span class="nav-post-count">24</span></a>
        <a href="/blog/heat-transfer/" class="nav-item">Heat-transfer<span class="nav-post-count">8</span></a>
        <a href="/blog/math/" class="nav-item">math<span class="nav-post-count">0</span></a>
        <a href="/blog/numerical-heat-transfer-and-fluid-flow/" class="nav-item">Numerical-Heat-transfer-and-Fluid-flow<span class="nav-post-count">14</span></a>
        <a href="/blog/solid-mechanics/" class="nav-item">Solid-Mechanics<span class="nav-post-count">25</span></a>
        <a href="/blog/thermodynamics/" class="nav-item">Thermodynamics<span class="nav-post-count">14</span></a>
        <a href="/blog/viscous-flow/" class="nav-item">Viscous-Flow<span class="nav-post-count">28</span></a>
        <a href="/blog/과학/" class="nav-item">과학<span class="nav-post-count">26</span></a>
        <a href="/blog/취미/" class="nav-item">취미<span class="nav-post-count">2</span></a>
      </nav>
    </aside>

    <!-- Main content -->
    <main class="main-content">
      <div class="breadcrumb">  <a href="/">Home</a><span class="sep">/</span>  <a href="/blog/computational-linear-algebra/">Computational-Linear-Algebra</a><span class="sep">/</span>  <span>ch (?) Fenicsx and Parallel Computing</span></div>
<a href="/blog/computational-linear-algebra/" class="back-link">&larr; Back to Computational-Linear-Algebra</a>
<div class="page-header"><h1>ch (?) Fenicsx and Parallel Computing</h1></div>
<div class="post-meta"><span class="meta-item"><span class="meta-label">Date:</span> 2025-10-30</span><span class="meta-item"><span class="meta-label">Category:</span> Computational-Linear-Algebra</span><span class="meta-item"><span class="meta-label">Source:</span> <a href="https://jeffdissel.tistory.com/m/245" target="_blank" rel="noopener">link</a></span></div>
<article class="post-content"><p>ch (?) Fenicsx and Parallel Computing<br />
나이가 먹을수록 기억력이 안좋아진다.<br />
사실 tistory는 더이상 관리를 안하는 블로그 API이지만,<br />
그럼에도 기억보관소로 사용중이다.<br />
아무튼, 이번시간에는 2가지를 정리해보자.<br />
1. FEniCS<br />
2. Parallel Computing<br />
(fenics 내부에 parallel compuating이 존재)<br />
<img alt="ch (?) Fenicsx and Parallel Computing" src="./images/img-001.png" /><br />
영국에서 만든 opensource FEM 연산 library<br />
https://fenicsproject.org/<br />
FEniCS<br />
Open-source finite element library<br />
fenicsproject.org<br />
우리가 지금 풀고 있는 FEM문제를<br />
open source code 로 공개한 꽤 각광받고 있는 library이다.<br />
2003년부터 University of Cambridge LAB에서부터 계발되어 왔고,<br />
주로 Solid mechanics structure problem을 풀다가,<br />
지금은 Heat, Navier's Stokes, ElectroMagnetic equation까지 확장하여,<br />
PDE를 FEM으로 푸는 library로 확장되었다.<br />
전체 workflow는 다음과 같다.<br />
<img alt="ch (?) Fenicsx and Parallel Computing" src="./images/img-002.png" /><br />
1. 일단 풀고자하는 문제를 .msh형태로 gmsh에서 mesh를 제작<br />
2. .msh 를 .xdmf로 전환하여 FEniCs가 읽을 수 있도록<br />
(최근 dolfinx.io.gmshio에서는 .msh바로 읽기 가능)<br />
3. 이후에 FEniCS에서 연산을 진행하면, 결과파일이 xdmf로 저장된다.<br />
4. 최종적으로 paraview에서 visualize.<br />
이중에서 FEniCS내부를 살펴보자.<br />
https://github.com/FEniCS<br />
FEniCS Project<br />
FEniCS Project has 18 repositories available. Follow their code on GitHub.<br />
github.com<br />
위 github에서 Project를 열어보면 4개의 핵심 package가 존재한다.<br />
<img alt="ch (?) Fenicsx and Parallel Computing" src="./images/img-003.png" /><br />
(github에 들어가게 되면, 어떻게 사용하는지 class, method전부 설명이 되어있고,<br />
오늘은 사용방법보다는 어떤식으로 구동되는지에 집중을 해보자)<br />
총 process를 diagram으로 그려보면 다음과 같다.<br />
하나씩 프로세스를 이해해보자.<br />
<img alt="ch (?) Fenicsx and Parallel Computing" src="./images/img-004.jpg" /><br />
total process of fenics<br />
1. User make python code and mesh<br />
<img alt="ch (?) Fenicsx and Parallel Computing" src="./images/img-005.png" /><br />
User가 먼저 fenics에서 제공한 문법에 맞게 어떻게 문제를 풀것인지 코드를 작성한다.<br />
(오늘은 python 코드 내용을 어떻게 구현해야하는 지는 다루지 않을것)<br />
<img alt="ch (?) Fenicsx and Parallel Computing" src="./images/img-006.png" /><br />
그리고 풀문제의 MESH를 xdmf or .msh형식으로 전달한다.<br />
<img alt="ch (?) Fenicsx and Parallel Computing" src="./images/img-007.png" /><br />
example of a mesh<br />
<img alt="ch (?) Fenicsx and Parallel Computing" src="./images/img-008.png" /><br />
inner tetrahedrone of inner mesh<br />
여기서핵심은, UFL이 우리가 정말<br />
수학적 문법<br />
에 맞게 python 코드를 작성할 수 있는 tool이라는 점이다.<br />
<img alt="ch (?) Fenicsx and Parallel Computing" src="./images/img-009.png" /><br />
Example of Linear elastic Weak form Ufl equation.<br />
<img alt="ch (?) Fenicsx and Parallel Computing" src="./images/img-010.png" /><br />
fem의 핵심은 Strong form -&gt; weak form이고,<br />
최종적인 weakform의 식을 그대로 ufl library를 이용해서 구현할 수 있다.<br />
(가장 큰 장점: 수학적 문법이 python 코드로 가능)<br />
2. Inner Kernel FFCX changes Python to C++<br />
<img alt="ch (?) Fenicsx and Parallel Computing" src="./images/img-011.png" /><br />
결국 컴퓨터 CPU 노드 연산을 하기 위해서 우리는 C++로 언어를 바꾸어야한다.<br />
이 작업을 이제 FFCX libaray가 진행을 해준다.<br />
더하여<br />
Basix<br />
는<br />
FEM의 가장 cornerstone인 Basis function을 정의하고, domain에 맞게 함수를 설정한다.<br />
<img alt="ch (?) Fenicsx and Parallel Computing" src="./images/img-012.png" /><br />
Simple hat form basis function(Linear)<br />
뿐만아니라, 우리는 연산을 진행할때, derivative or scalar, vector function value모두<br />
reference frame으로 전환후 연산을 진행한다.<br />
여기서 reference frame과 실제 spatial frame의 mapping도 basix가 담당한다.<br />
<img alt="ch (?) Fenicsx and Parallel Computing" src="./images/img-013.jpg" /><br />
(쉽게 말해 BASIX는 FEM의 핵심이 되는 기본적인 연산들을 담당한다)<br />
3. Dolfinx 는 위의 연산 함수들과 input output을 종합해주는 즉 orchestration을 진행한다.<br />
(가장 핵심)<br />
<img alt="ch (?) Fenicsx and Parallel Computing" src="./images/img-014.png" /><br />
https://docs.fenicsproject.org/dolfinx/main/python/api.html<br />
API reference — DOLFINx 0.10.0.0 documentation<br />
© Copyright 2025, FEniCS Project.<br />
docs.fenicsproject.org<br />
python코드를 작성하실때 가장 핵심이 되는 library이고 자세한 API는 위 싸이트에 다 정의되어 있다.<br />
(현시점 version 0.10)<br />
<img alt="ch (?) Fenicsx and Parallel Computing" src="./images/img-015.png" /><br />
API reference screenshot<br />
4. Solve the problem<br />
결국 doflinx가 하는일은 A, b를 weak form에서 정의하는 일이다. 우리가 구하고 싶은 것은 x<br />
(Ax = b 를 컴퓨터에서 어떻게 풀지는 우리가 ch1~8 까지 다루어 왔다)<br />
https://jeffdissel.tistory.com/244<br />
Ch8. Krylov subspace<br />
Ax = b풀고있다 우리는. #푸는방식direct method -&gt; classical iterative method -&gt; 를 지나서, Krylov subspace iterative method에 도착하였다. Motivation:우리가 기존에 풀던 classical iterative method는 sparse large matrix를 풀기<br />
jeffdissel.tistory.com<br />
가장 대표적인 Krylov subspace method -&gt; Preconditioner Conjugate gradient or GMRES 이 두가지를 가장 많이 사용<br />
<img alt="ch (?) Fenicsx and Parallel Computing" src="./images/img-016.png" /><br />
이미 굉장한 수학적? 개발자들이 연산하는 C++ package를 개발해 왔고, 그중에 PETSc를 피닉스는 사용한다.<br />
<img alt="ch (?) Fenicsx and Parallel Computing" src="./images/img-017.png" /><br />
이 라이브러리의 핵심은 단순히 GMRES, PCG를 쓰는게 아니라,<br />
병렬연산에 최적화되어 있다는 점이다.<br />
사실 병렬연산 진행은 OPEN MPI package를 통해 실행을 한다.<br />
<img alt="ch (?) Fenicsx and Parallel Computing" src="./images/img-018.png" /><br />
FEM에서 푸는 문제 자체가 굉장히 A 행렬이 거대하기 때문에, 우리는 나누어서 대부분 연산을 한다.<br />
Open MPI는 cluster즉 여러개의 컴퓨터를 가지고 연산을 할때 사용되고,<br />
밑에 보시는 것처럼 컴퓨터 여러개 끼리 서로 communicate하면서 각자의 연산을 할 수 있게 해준다.<br />
<img alt="ch (?) Fenicsx and Parallel Computing" src="./images/img-019.jpg" /><br />
예를들어, 우리가 아래의 fixed beam 문제를 풀때,<br />
element 3개 에따라서 computer 3개로 나눈다고 하자.<br />
<img alt="ch (?) Fenicsx and Parallel Computing" src="./images/img-020.jpg" /><br />
보시는 것처럼 element단위로 쪼개개 되면, shared node가 생기게 된다.<br />
따라서 computer끼리 communication이 필요한 것.<br />
위 작업을 쉽게 진행해주는 package가 바로 OPEN MPI인 것.<br />
반대로, 만약에 우리가 5개의 독립적인 문제를 푼다고 한다면???<br />
5개의 문제끼리는 행렬이 아예 다르기 때문에 서로 shared 할 필요가 없다.<br />
(즉, communication setting을 OPEN MPI처럼 굳이 하지 않아도 된다)<br />
<img alt="ch (?) Fenicsx and Parallel Computing" src="./images/img-021.png" /><br />
5 Independent Static Problems<br />
이때 사용되는 package는 OPEN MPI가 아닌 (햇갈리는)이름인 OPENMP<br />
<img alt="ch (?) Fenicsx and Parallel Computing" src="./images/img-022.png" /><br />
<img alt="ch (?) Fenicsx and Parallel Computing" src="./images/img-023.jpg" /><br />
즉 한개의 matser computer 가 shared Memory를 가지고 있고,<br />
연산을 여러개의 CPU로 나누어 진행하는 방식이다.<br />
5. Output the problem<br />
자 이렇게 병렬연산을 진행한 이후에, dolfinx는 xdmf형식으로 output을 만들어 준다.<br />
<img alt="ch (?) Fenicsx and Parallel Computing" src="./images/img-024.png" /><br />
고체 문제에서 solution x - displacement이므로,<br />
<img alt="ch (?) Fenicsx and Parallel Computing" src="./images/img-025.png" /><br />
위 코드를 python에서 실행하면,<br />
paraview에서 displacment를 visualize할 수 있게 된다.<br />
<img alt="ch (?) Fenicsx and Parallel Computing" src="./images/img-026.png" /><br />
여기까지 FENIC에서 workflow를 전체적으로 이해해보았고,<br />
한번 어떤 흐름으로 구동하는지를 이해하면,<br />
이후 python코드를 작성하는데 당연히 도움이 된다고 생각하여,<br />
작성하였다.</p></article>
      <footer class="site-footer">
        <p>&copy; 2026 Sehyeog Kim. Built with gitfolio-inspired theme.</p>
      </footer>
    </main>
  </div>

  <script src="../../../assets/js/main.js"></script>
</body>
</html>